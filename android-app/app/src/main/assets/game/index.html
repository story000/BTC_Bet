<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bitcoin Prediction Game</title>
    <script type="module" crossorigin src="./assets/index-CDbEBvwM.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-BRCbO9yf.css">
  </head>
  <body>
    <div id="root"></div>
    <script>
      (() => {
        const params = new URLSearchParams(window.location.search);
        const savedBase = localStorage.getItem("cryptoBaseUrl");
        const baseUrlRaw = params.get("server") || savedBase || `${window.location.origin}/`;
        const baseUrl = baseUrlRaw.endsWith("/") ? baseUrlRaw : `${baseUrlRaw}/`;
        const symbol = (params.get("symbol") || "BTCUSD").toUpperCase();
        localStorage.setItem("cryptoBaseUrl", baseUrl);

        async function fetchPrice() {
          try {
            const res = await fetch(`${baseUrl}api/price?symbol=${encodeURIComponent(symbol)}`);
            const data = await res.json();
            const price = parseFloat(data.price);
            if (!Number.isNaN(price) && typeof window.updatePrice === "function") {
              window.updatePrice(price);
            }
          } catch (err) {
            console.error("Failed to fetch price", err);
          }
        }

        setInterval(fetchPrice, 1000);
        fetchPrice();
      })();
    </script>
  </body>
</html>
